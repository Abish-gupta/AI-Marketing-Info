<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Marketing Research Request</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto:700,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
      font-family: 'Roboto', Arial, sans-serif;
      height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(60, 80, 90, 0.14);
      max-width: 450px;
      width: 95%;
      padding: 2rem 2.5rem;
      text-align: left;
      min-width: 310px;
    }
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.2rem;
    }
    .logo-icon {
      font-size: 2.4rem;
      color: #3172b7;
      margin-right: 0.7rem;
    }
    .title {
      font-size: 2rem;
      font-weight: 700;
      color: #25456B;
      margin-bottom: 0.2rem;
      text-align: center;
    }
    .subtitle {
      text-align: center;
      font-size: 1.04rem;
      color: #497783;
      margin-bottom: 1.4rem;
    }
    .field-label {
      display: flex;
      align-items: center;
      font-weight: bold;
      font-size: 1.05rem;
      color: #225ea8;
      margin-bottom: 0.5rem;
    }
    .field-label .fa {
      margin-right: 0.5em;
      font-size: 1.22rem;
      color: #3172b7;
      opacity: 0.95;
    }
    input {
      width: 100%;
      padding: 0.7rem 0.8rem;
      border-radius: 0.5rem;
      border: 1.5px solid #c0d3e6;
      margin-bottom: 1.1rem;
      font-size: 1rem;
      background: #f8fbfc;
      transition: border-color 0.2s;
      box-sizing: border-box;
    }
    input:focus {
      border-color: #3172b7;
      outline: none;
    }
    .submit-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 1rem;
      margin-top: 0.8rem;
      font-size: 1.09rem;
      background: #3172b7;
      color: white;
      font-weight: 700;
      border: none;
      border-radius: 0.55rem;
      cursor: pointer;
      transition: background 0.17s;
      letter-spacing: 0.03em;
    }
    .submit-btn:hover {
      background: #225ea8;
    }
    .toast {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: -65px;
      background: #3172b7;
      color: #fff;
      padding: 1em;
      border-radius: 0.5em;
      display: none;
      z-index: 22;
    }
    .toast.show { display: block; }

    /* Loading overlay */
    #loading {
      display:none;
      position:fixed;
      top:0; left:0; width:100%; height:100%;
      background:rgba(255,255,255,0.8);
      backdrop-filter: blur(3px);
      z-index:9999;
      font-size:1.4rem;
      font-weight:600;
      color:#225ea8;
      text-align:center;
      padding-top:20%;
    }
  </style>
</head>
<body>

<div class="card">
  <div class="logo">
    <i class="fa-solid fa-chart-line logo-icon"></i>
    <span class="title">Marketing Research Request</span>
  </div>
  <div class="subtitle">Fill out company details to get automated insights.</div>

  <form id="researchForm">
    <div class="field-label"><i class="fa-solid fa-building"></i>Company Name *</div>
    <input type="text" id="companyName" name="companyName" placeholder="aGi" required maxlength="80">

    <div class="field-label"><i class="fa-solid fa-globe"></i>Company Website (optional)</div>
    <input type="url" id="websiteUrl" name="websiteUrl" placeholder="https://abishgupta.com">

    <div class="field-label"><i class="fa-solid fa-envelope"></i>Your Email *</div>
    <input type="email" id="yourEmail" name="yourEmail" placeholder="abish.guptaa@example.com" required>

    <button type="submit" class="submit-btn"><i class="fa-solid fa-paper-plane"></i>Submit Request</button>
  </form>

  <div class="toast" id="successMsg">✅ Email sent successfully!</div>
  <div class="toast" id="errorMsg" style="background:#ff5e57;">❌ Something went wrong</div>
</div>

<div id="loading">⏳ Processing your request...<br> Please wait...</div>

<script>
window.onload = function() {
  document.getElementById('companyName').value = localStorage.getItem('companyName') || '';
  document.getElementById('websiteUrl').value = localStorage.getItem('websiteUrl') || '';
  document.getElementById('yourEmail').value = localStorage.getItem('yourEmail') || '';
};

const form = document.getElementById('researchForm');
form.addEventListener('submit', async function(e) {
  e.preventDefault();

  document.getElementById('successMsg').classList.remove('show');
  document.getElementById('errorMsg').classList.remove('show');

  const submitBtn = document.querySelector('.submit-btn');
  submitBtn.disabled = true;
  submitBtn.textContent = "Processing...";
  document.getElementById('loading').style.display = "block";

  let websiteVal = document.getElementById('websiteUrl').value.trim();
  if (websiteVal && !/^https?:\/\//i.test(websiteVal)) {
    websiteVal = 'https://' + websiteVal;
  }

  const data = {
    companyName: document.getElementById('companyName').value,
    websiteUrl: websiteVal,
    yourEmail: document.getElementById('yourEmail').value
  };

  try {
    const response = await fetch('https://abishgupta2.app.n8n.cloud/webhook-test/11983700-73fd-445c-a61d-8a6de3285ee', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    if (response.ok) {
      document.getElementById('successMsg').classList.add('show');
      form.reset();
    } else {
      throw new Error();
    }
  } catch {
    document.getElementById('errorMsg').classList.add('show');
  } finally {
    submitBtn.disabled = false;
    submitBtn.textContent = "Submit Request";
    document.getElementById('loading').style.display = "none";
  }
});
</script>

</body>
</html>

